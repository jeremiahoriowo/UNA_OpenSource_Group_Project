
 {
function BxDolUploaderBase(sUploaderObject,sStorageObject,sUniqId,options){this.init(sUploaderObject,sStorageObject,sUniqId,options);this._sIframeId='bx-form-input-files-'+sUniqId+'-iframe';this._eForm=null}
BxDolUploaderBase.prototype.init=function(sUploaderObject,sStorageObject,sUniqId,options){this._isUploadsInProgress=!1;this._sUploaderObject=sUploaderObject;this._sStorageObject=sStorageObject;this._sUniqId=sUniqId;this._sUploaderJsInstance='glUploader_'+sUniqId+'_'+this._sUploaderObject;this._sUploadInProgressContainerId='bx-form-input-files-'+sUniqId+'-upload-in-progress-'+this._sUploaderObject;this._sPopupContainerId='bx-form-input-files-'+sUniqId+'-popup-wrapper-'+this._sUploaderObject;this._sResultContainerId='bx-form-input-files-'+sUniqId+'-upload-result';this._sErrorsContainerId='bx-form-input-files-'+sUniqId+'-errors';this._sProgressContainerId='bx-form-input-files-'+sUniqId+'-progress';this._sFormContainerId='bx-form-input-files-'+sUniqId+'-form-cont';this._sTemplateGhost=options.template_ghost?options.template_ghost:'<div id="'+this._getFileContainerId('{file_id}')+'"><input type="hidden" name="f[]" value="{file_id}" />{file_name} (<a href="javascript:void(0);" onclick="{js_instance_name}.deleteGhost(\'{file_id}\')">delete</a>)</div>';this._sTemplateReorder=options.template_reorder?options.template_reorder:'<div class="bx-uploader-ghost-reorder bx-btn bx-btn-small"><i class="sys-icon bars"></i></div>';this._sTemplateError=options.template_error_msg?options.template_error_msg:'<div>{error}</div>';this._sTemplateErrorGhosts=options.template_error_ghosts?options.template_error_ghosts:this._sTemplateError;this._isMultiple=undefined==options.multiple||!options.multiple?!1:!0;this._isReordering=undefined==options.reordering||!options.reordering?!1:!0;this._iContentId=undefined==options.content_id||''==options.content_id?'':parseInt(options.content_id);this._sImagesTranscoder=options.images_transcoder?options.images_transcoder:'';this._isPrivate=undefined==options.storage_private||parseInt(options.storage_private)?1:0;this._isErrorShown=!1;this._onUploadBefore=typeof options.on_upload_before==='function'?options.on_upload_before:function(){};this._onUpload=typeof options.on_upload==='function'?options.on_upload:function(){};this._onRestoreGhosts=typeof options.on_restore_ghosts==='function'?options.on_restore_ghosts:function(){}}
BxDolUploaderBase.prototype.isMultiple=function(){return this._isMultiple}
BxDolUploaderBase.prototype.getCurrentFilesCount=function(){return $('#'+$this._sResultContainerId+' .bx-uploader-ghost').length}
BxDolUploaderBase.prototype.showUploaderForm=function(){var $this=this;var sUrl=this._getUrlWithStandardParams()+'&a=show_uploader_form&m='+(this._isMultiple?1:0)+'&c='+this._iContentId+'&p='+this._isPrivate+'&_t='+escape(new Date());$(window).dolPopupAjax({url:sUrl,id:{force:!0,value:this._sPopupContainerId},onBeforeShow:function(){if($this.isMultiple())
$('#'+$this._sPopupContainerId+' .bx-uploader-add-more-files').show();else $('#'+$this._sPopupContainerId+' .bx-uploader-add-more-files').hide();$('#'+$this._sPopupContainerId+' .bx-popup-element-close').click(function(){$this.onClickCancel()});$("#"+$this._sFormContainerId+" .bx-btn.bx-btn-primary:not(.bx-crop-upload)").hide();if('undefined'!==typeof($this.onBeforeShowPopup))
$this.onBeforeShowPopup();},onShow:function(){if('undefined'!==typeof($this.onShowPopup))
$this.onShowPopup();},closeElement:!1,closeOnOuterClick:!1})}
BxDolUploaderBase.prototype.onClickCancel=function(){var $this=this;if(this._isUploadsInProgress){bx_confirm(_t('_sys_uploader_confirm_close_popup'),function(){$this.cancelAll();$('#'+$this._sPopupContainerId).dolPopupHide({})})}else{$('#'+this._sPopupContainerId).dolPopupHide()}}
BxDolUploaderBase.prototype.onBeforeUpload=function(params){this._eForm=params;this._loading(!0,!1);this._isUploadsInProgress=!0;this._lockPageFromLeaving();this._clearErrors();if(typeof this._onUploadBefore==='function')
this._onUploadBefore(this);}
BxDolUploaderBase.prototype.onProgress=function(params){}
BxDolUploaderBase.prototype.onUploadCompleted=function(sErrorMsg){this._isUploadsInProgress=!1;this._unlockPageFromLeaving();this._loading(!1,!0);if(sErrorMsg.length){this.restoreGhosts();this._showError(sErrorMsg)}else{this.restoreGhosts();$('#'+this._sPopupContainerId).dolPopupHide({});if(typeof this._onUpload==='function')
this._onUpload(this,this._iContentId);}}
BxDolUploaderBase.prototype.cancelAll=function(){$('#'+this._sIframeId).attr('src','javascript:false;');this.onUploadCompleted(_t('_sys_uploader_upload_canceled'))}
BxDolUploaderBase.prototype.restoreGhosts=function(bInitReordering,onComplete){var sUrl=this._getUrlWithStandardParams()+'&img_trans='+this._sImagesTranscoder+'&a=restore_ghosts&f=json'+'&c='+this._iContentId+'&_t='+escape(new Date());var $this=this;bInitReordering=bInitReordering!==undefined?bInitReordering:this._isReordering;$.getJSON(sUrl,function(aData){if(!$this.isMultiple())
$('#'+$this._sResultContainerId+' .bx-uploader-ghost').remove();if('object'===typeof(aData)){if('object'===typeof(aData.g)&&'object'===typeof(aData.o))
for(var i in aData.o){var iFileId=aData.o[i];$this.showGhost(iFileId,aData.g[iFileId])}else $.each(aData,function(iFileId,oVars){$this.showGhost(iFileId,oVars)});$('#'+$this._sResultContainerId).bx_show_more_check_overflow();if(bInitReordering){var sClassGhost='bx-uploader-ghost';$('#'+$this._sResultContainerId).find('.'+sClassGhost).each(function(){if($(this).find('.bx-uploader-ghost-reorder').length==0)
$(this).find('.bx-base-general-uploader-ghost').prepend($this._sTemplateReorder);});var fInitReordering=function(){$('#'+$this._sResultContainerId).sortable({items:'.'+sClassGhost,start:function(oEvent,oUi){oUi.item.addClass('bx-uploader-ghost-dragging')},stop:function(oEvent,oUi){oUi.item.removeClass('bx-uploader-ghost-dragging');$this.reorderGhosts(oUi.item)}})};if($.sortable!==undefined)
fInitReordering();else setTimeout(fInitReordering,2000)}}
if(typeof onComplete==='function')
onComplete(aData);if(typeof this._onRestoreGhosts==='function')
this._onRestoreGhosts($this,aData);})};BxDolUploaderBase.prototype.reorderGhosts=function(oDraggable){var sUrl=this._getUrlWithStandardParams()+'&a=reorder_ghosts&f=json'+'&c='+this._iContentId+'&'+$('#'+this._sResultContainerId).sortable('serialize',{key:'ghosts[]'})+'&_t='+escape(new Date());$.getJSON(sUrl,function(aData){processJsonData(aData)})};BxDolUploaderBase.prototype.showGhost=function(iId,oVars){var oFileContainer=$('#'+this._getFileContainerId(iId));if(oFileContainer.length>0)
return;var sHTML;if(typeof this._sTemplateGhost=='object')
sHTML=this._sTemplateGhost[iId];else sHTML=this._sTemplateGhost;for(var i in oVars)
sHTML=sHTML.replace(new RegExp('{'+i+'}','g'),oVars[i]);$('#'+this._sResultContainerId).append(sHTML).trigger("contentchange");oFileContainer.find('.bx-uploader-ghost-preview img').hide().fadeIn(1000);};BxDolUploaderBase.prototype.deleteGhost=function(iFileId,onComplete){var sUrl=this._getUrlWithStandardParams()+'&a=delete&id='+iFileId;var $this=this;var sFileContainerId=$this._getFileContainerId(iFileId);bx_loading(sFileContainerId,!0);$.post(sUrl,{_t:escape(new Date())},function(sMsg){var fOnComplete=function(sMsg){if(typeof onComplete==='function')
onComplete(sMsg);};bx_loading(sFileContainerId,!1);if('ok'==sMsg){$('#'+sFileContainerId).slideUp('slow',function(){$(this).remove();fOnComplete(sMsg)})}else{$('#'+this._sResultContainerId).prepend($this._sTemplateErrorGhosts.replace('{error}',sMsg));fOnComplete(sMsg)}})};BxDolUploaderBase.prototype._clearErrors=function(){$(' #'+this._sErrorsContainerId).html('');this._isErrorShown=!1}
BxDolUploaderBase.prototype._showError=function(s,bAppend){if(s==undefined||!s.length)
return;var eCont=$('#'+this._sPopupContainerId).find('[id='+this._sErrorsContainerId+']').size()?$('#'+this._sPopupContainerId).find('[id='+this._sErrorsContainerId+']'):$('#'+this._sErrorsContainerId);if(!bAppend)
eCont.html(this._sTemplateError.replace('{error}',s));else eCont.prepend(this._sTemplateError.replace('{error}',s));this._isErrorShown=!0};BxDolUploaderBase.prototype._getFileContainerId=function(iFileId){return'bx-uploader-file-'+this._sStorageObject+'-'+iFileId};BxDolUploaderBase.prototype._getUrlWithStandardParams=function(){return sUrlRoot+'storage_uploader.php?uo='+this._sUploaderObject+'&so='+this._sStorageObject+'&uid='+this._sUniqId}
BxDolUploaderBase.prototype._lockPageFromLeaving=function(){$(window).bind('beforeunload',function(e){var e=e||window.event;e.returnValue=_t('_sys_uploader_confirm_leaving_page');return _t('_sys_uploader_confirm_leaving_page')})}
BxDolUploaderBase.prototype._unlockPageFromLeaving=function(){$(window).unbind('beforeunload')}
BxDolUploaderBase.prototype._loading=function(bShowProgress,bShowForm){var eForm=$('#'+this._sFormContainerId+' .bx-uploader-files-list');var eBtn=$('#'+this._sFormContainerId+' .bx-btn-primary');if(bShowForm){if(null!=this._eForm){eForm.find('.bx-uploader-simple-file').filter(':not(:first)').remove();if('undefined'!==typeof(this._eForm.reset))
this._eForm.reset();}
eForm.show();eBtn.show()}else{eForm.hide();eBtn.hide()}
bx_loading($('#'+this._sFormContainerId+' .bx-uploader-loading').get(0),bShowProgress)}
BxDolUploaderBase.prototype.getMimeTypefromString=function(ext){var mimeTypes={'3gp':'video/3gpp','3g2':'video/3gpp2','a':'application/octet-stream','ai':'application/postscript','aif':'audio/x-aiff','aifc':'audio/x-aiff','aiff':'audio/x-aiff','asf':'video/x-ms-asf','au':'audio/basic','avi':'video/x-msvideo','avi':'video/avi','bat':'text/plain','bin':'application/octet-stream','bmp':'image/x-ms-bmp','c':'text/plain','cdf':'application/x-cdf','csh':'application/x-csh','css':'text/css','divx':'video/divx','dll':'application/octet-stream','doc':'application/msword','dot':'application/msword','drc':'video/drc','dvi':'application/x-dvi','eml':'message/rfc822','eps':'application/postscript','etx':'text/x-setext','exe':'application/octet-stream','gif':'image/gif','gtar':'application/x-gtar','h':'text/plain','hdf':'application/x-hdf','htm':'text/html','html':'text/html','jpe':'image/jpeg','jpeg':'image/jpeg','jpg':'image/jpeg','js':'application/x-javascript','ksh':'text/plain','latex':'application/x-latex','m1v':'video/mpeg','man':'application/x-troff-man','me':'application/x-troff-me','mht':'message/rfc822','mhtml':'message/rfc822','mkv':'video/x-matroska','mif':'application/x-mif','mov':'video/quicktime','movie':'video/x-sgi-movie','mp2':'audio/mpeg','mp3':'audio/mpeg','mp4':'video/mp4','m4v':'video/mp4','mpa':'video/mpeg','mpe':'video/mpeg','mpeg':'video/mpeg','mpg':'video/mpeg','ms':'application/x-troff-ms','nc':'application/x-netcdf','nws':'message/rfc822','o':'application/octet-stream','obj':'application/octet-stream','oda':'application/oda','ogv':'video/ogg','ogg':'video/ogg','pbm':'image/x-portable-bitmap','pdf':'application/pdf','pfx':'application/x-pkcs12','pgm':'image/x-portable-graymap','png':'image/png','pnm':'image/x-portable-anymap','pot':'application/vnd.ms-powerpoint','ppa':'application/vnd.ms-powerpoint','ppm':'image/x-portable-pixmap','pps':'application/vnd.ms-powerpoint','ppt':'application/vnd.ms-powerpoint','pptx':'application/vnd.ms-powerpoint','ps':'application/postscript','pwz':'application/vnd.ms-powerpoint','py':'text/x-python','pyc':'application/x-python-code','pyo':'application/x-python-code','qt':'video/quicktime','ra':'audio/x-pn-realaudio','ram':'application/x-pn-realaudio','ras':'image/x-cmu-raster','rdf':'application/xml','rgb':'image/x-rgb','rm':'application/vnd.rn-realmedia','rmvb':'application/vnd.rn-realmedia-vbr','roff':'application/x-troff','rtx':'text/richtext','sgm':'text/x-sgml','sgml':'text/x-sgml','sh':'application/x-sh','shar':'application/x-shar','snd':'audio/basic','so':'application/octet-stream','src':'application/x-wais-source','swf':'application/x-shockwave-flash','t':'application/x-troff','tar':'application/x-tar','tcl':'application/x-tcl','tex':'application/x-tex','texi':'application/x-texinfo','texinfo':'application/x-texinfo','tif':'image/tiff','tiff':'image/tiff','tr':'application/x-troff','tsv':'text/tab-separated-values','txt':'text/plain','ustar':'application/x-ustar','vcf':'text/x-vcard','wav':'audio/x-wav','wav':'audio/wav','webm':'video/webm','wmv':'video/wmv','wiz':'application/msword','wsdl':'application/xml','xbm':'image/x-xbitmap','xlb':'application/vnd.ms-excel','xls':'application/vnd.ms-excel','xlsx':'application/vnd.ms-excel','xml':'text/xml','xpdl':'application/xml','xpm':'image/x-xpixmap','xsl':'application/xml','xvid':'video/xvid','webp':'image/webp','xwd':'image/x-xwindowdump','svg':'image/svg+xml','zip':['application/zip','application/x-zip-compressed']}
return mimeTypes[ext.replace('.','')]}
function BxDolUploaderHTML5(sUploaderObject,sStorageObject,sUniqId,options){this.init(sUploaderObject,sStorageObject,sUniqId,options);this._sIframeId='bx-form-input-files-'+sUniqId+'-iframe';this._eForm=null;this._sDivId='bx-form-input-files-'+sUniqId+'-div-'+this._sUploaderObject;this._sFocusDivId='bx-form-input-files-'+sUniqId+'-focus-'+this._sUploaderObject;this._uploader=null;this._aFiles=[];this.initUploader=function(o){var $this=this;if(null!=this._uploader)
this._uploader=null;var $this=this;var _options={allowProcess:!1,allowPaste:!1,allowRevert:!1,allowRemove:!1,imagePreviewHeight:100,credits:{},allowMultiple:$this._isMultiple?!0:!1,maxFiles:$this.isMultiple()?50:1,maxFileSize:o.maxFilesize>2?Math.round(o.maxFilesize)+'MB':Math.round(o.maxFilesize*1024)+'KB',instantUpload:!0,onaddfile:(error,file)=>{if(error){$this._uploader.removeFile(file);if($this._uploader.status!=3)
$this.onUploadCompleted('');}else{$this.onBeforeUpload('')}},onerror:(error)=>{if(error.main)
$this._showError(error.main+'. '+error.sub);},onprocessfiles:(files)=>{$this.onUploadCompleted('');oProgress.hide();$this._aFiles=[]},onprocessfileprogress(file,progress){$this._aFiles[file.source.lastModified+'-'+file.source.size+'-'+file.source.name]=progress*file.source.size;iTotal=0;iUploaded=0;for(const propertyName in $this._aFiles){iUploaded+=$this._aFiles[propertyName]}
for(i=0;i<$this._uploader.getFiles().length;i++){iTotal+=$this._uploader.getFiles()[i].source.size}
iProgress=iUploaded/iTotal*100;oProgress=$('#'+$this._sProgressContainerId);if(oProgress.parents('.bx-db-container').find('.uploader_progress').length>0){oProgress=oProgress.parents('.bx-db-container').find('.uploader_progress')}
oProgress.show();oProgress.find('.progress_line').css('width',iProgress+'%')},server:{process:(fieldName,file,metadata,load,error,progress,abort)=>{const formData=new FormData();formData.append('file',file,file.name);formData.append('uo',this._sUploaderObject);formData.append('so',this._sStorageObject);formData.append('uid',this._sUniqId);formData.append('m',this._isMultiple?1:0);formData.append('c',this._iContentId);formData.append('p',this._isPrivate);formData.append('a','upload');const request=new XMLHttpRequest();request.open('POST',sUrlRoot+'storage_uploader.php');request.upload.onprogress=(e)=>{progress(e.lengthComputable,e.loaded,e.total)};request.onload=function(res){if(request.status>=200&&request.status<300){var o=null;try{o=JSON.parse(request.responseText)}catch(e){}
if(o&&'undefined'!==typeof(o.error)){$this._showError(o.error,!0)}
load(request.responseText)}else{error('error')}};request.send(formData)}},};aAcceptableFiles=[];if(o.acceptedFiles&&o.acceptedFiles!=''){a=o.acceptedFiles.trim().split(/\s*,\s*/);a.forEach(function(item,i,arr){if($this.getMimeTypefromString(item)){oT=$this.getMimeTypefromString(item);if(Array.isArray(oT)){oT.forEach(function(oTs,j,ar){aAcceptableFiles.push(oTs)})}else{aAcceptableFiles.push(oT)}}})}
if(aAcceptableFiles.length){_options.acceptedFileTypes=aAcceptableFiles}
if(o.resizeWidth||o.resizeHeight){_options.allowImageResize=!0;_options.imageResizeTargetWidth=o.resizeWidth;_options.imageResizeTargetHeight=o.resizeHeight;_options.imageResizeMode=o.resizeMethod}else{_options.allowImageResize=!1;_options.allowImageTransform=!1}
FilePond.registerPlugin(FilePondPluginImagePreview,FilePondPluginFileValidateType,FilePondPluginFileValidateSize,FilePondPluginImageTransform,FilePondPluginImageCrop,FilePondPluginImageResize,);this._uploader=FilePond.create(document.querySelector('#'+this._sDivId),$.extend({},_options,o));this._uploader.setOptions(glFilepondLocale)}
this.onUploadCompleted=function(sErrorMsg){if(sErrorMsg.length)
this._showError(sErrorMsg);var $this=this;if($this._uploader.status!=3){this._isUploadsInProgress=!1;this.restoreGhosts();if(!this._isErrorShown){$('#'+this._sPopupContainerId).dolPopupHide({});this.removeFiles()}
if(typeof this._onUpload==='function')
this._onUpload(this,this._iContentId);}}
this.removeFiles=function(){oFiles=this._uploader.getFiles();for(i=0;i<oFiles.length;i++){this._uploader.removeFile(i)}}
this.cancelAll=function(){this.removeFiles()}
this.onBeforeUpload=function(params){this._isUploadsInProgress=!0;this._clearErrors();if(typeof this._onUploadBefore==='function')
this._onUploadBefore(this);}
this.onProgress=function(params){}
this.onClickCancel=function(){var $this=this;if(this._isUploadsInProgress){bx_confirm(_t('_sys_uploader_confirm_close_popup'),function(){$this.removeFiles();$this.cancelAll();$('#'+$this._sPopupContainerId).dolPopupHide({})})}else{$this.removeFiles();$('#'+this._sPopupContainerId).dolPopupHide()}
BxDolUploaderBase.prototype._clearErrors.call(this)}
this.onShowPopup=function(){var $this=this;setTimeout(function(){$this.focusPasteEditor()},200)}
this.focusPasteEditor=function(){$('#'+this._sFocusDivId).focus()}
this.initPasteEditor=function(){var $this=this;$('#'+this._sFocusDivId).on('paste',function(e){var aFiles=[];if(e.type=='paste'){var aItems=(e.clipboardData||e.originalEvent.clipboardData).items;for(var i in aItems){var oItem=aItems[i];if(oItem.kind==='file')
aFiles.push(oItem.getAsFile());}
$this._uploader.addFiles(aFiles)}})}
this.showUploaderForm=function(){this._uploader.browse()}
this.initUploader({'maxFilesize':options.maxFilesize,'acceptedFiles':options.acceptedFiles,'resizeWidth':options.resizeWidth,'resizeHeight':options.resizeHeight,'resizeMethod':options.resizeMethod,'dictDefaultMessage':options.dictDefaultMessage,'dictFileTooBig':options.dictFileTooBig,'dictMaxFilesExceeded':options.dictMaxFilesExceeded,'dictInvalidFileType':options.dictInvalidFileType,})}
BxDolUploaderHTML5.prototype=BxDolUploaderBase.prototype;function BxDolUploaderSimple(sUploaderObject,sStorageObject,sUniqId,options){BxDolUploaderHTML5.call(this,sUploaderObject,sStorageObject,sUniqId,options)}
BxDolUploaderSimple.prototype=Object.create(BxDolUploaderHTML5.prototype);BxDolUploaderSimple.prototype.constructor=BxDolUploaderSimple;function BxDolUploaderCrop(sUploaderObject,sStorageObject,sUniqId,options){this.init(sUploaderObject,sStorageObject,sUniqId,options);this._eForm=null;this.initUploader=function(oOptions){var $this=this;var aExt=['jpg','jpeg','png','gif','webp'];var eCroppie=$("#"+this._sFormContainerId+" .bx-croppie-element").croppie(oOptions);$("#"+this._sFormContainerId+' .bx-crop-rotate').on('click',function(ev){eCroppie.croppie('rotate',parseInt($(this).data('deg')))});$("#"+this._sFormContainerId+" input[name=f]").on("change",function(){var input=this;if(input.files&&input.files[0]){var m=input.files[0].name.match(/\.([A-Za-z0-9]+)$/);if(2!=m.length||-1==aExt.indexOf(m[1].toLowerCase())){$(input).replaceWith($(input).val('').clone(!0));$this._showError(_t('_sys_uploader_crop_wrong_ext'));return}
$this._clearErrors();var reader=new FileReader()
reader.onload=function(e){eCroppie.croppie('bind',{url:e.target.result});$("#"+$this._sFormContainerId+" .bx-croppie-element").addClass('ready');$("#"+$this._sFormContainerId+" .bx-crop-action").removeClass('bx-btn-disabled');$("#"+$this._sFormContainerId+" .bx-croppie-element").data('bx-filename',input.files[0].name.replace(/(\.[A-Za-z0-9]+)$/,'.jpg'))}
reader.readAsDataURL(input.files[0])}});$("#"+this._sFormContainerId+" .bx-crop-upload").on('click',function(ev){eCroppie.croppie('result',{type:'canvas',size:'original',format:'jpeg',quality:'0.85',}).then(function(resp){var fd=new FormData();fd.append("f",dataURItoBlob(resp),$("#"+$this._sFormContainerId+" .bx-croppie-element").data('bx-filename'));$.each(oOptions.bx_form,function(sName){fd.append(sName,this)});$this.onBeforeUpload(fd);$.ajax({url:sUrlRoot+'storage_uploader.php',type:"POST",processData:!1,contentType:!1,data:fd,success:function(data){eval(data)},error:function(){$this._showError(_t('_sys_uploader_crop_err_upload'))}})})});function dataURItoBlob(dataURI){var split=dataURI.split(','),dataTYPE=split[0].match(/:(.*?);/)[1],binary=atob(split[1]),array=[];for(var i=0;i<binary.length;i++)
array.push(binary.charCodeAt(i));return new Blob([new Uint8Array(array)],{type:dataTYPE})}}}
BxDolUploaderCrop.prototype=BxDolUploaderBase.prototype;function BxDolUploaderRecordVideo(sUploaderObject,sStorageObject,sUniqId,options){this._camera=null;this._blob=null;this._recorder=null;this._camera_type='user';this._audio_bitrate=undefined!==options.audio_bitrate?parseInt(options.audio_bitrate):128000;this._video_bitrate=undefined!==options.video_bitrate?parseInt(options.video_bitrate):1000000;this.init(sUploaderObject,sStorageObject,sUniqId,options);this.showUploaderForm=function(){if(typeof MediaRecorder=='undefined'||!('requestData' in MediaRecorder.prototype)){bx_alert(_t('_sys_uploader_unsupported_browser'));return}
BxDolUploaderBase.prototype.showUploaderForm.call(this)}
this.onBeforeShowPopup=function(){this._blob=null;this._camera=null;this._recorder=null
this._clearErrors();$('#bx-upoloader-recording-preview').hide();$('#bx-upoloader-camera-capture').show();$('#'+this._sFormContainerId+' .bx-uploader-record-video-controls').hide()}
this.switchCamera=function(){this._camera_type=this._camera_type=='user'?'environment':'user';this.releaseCamera();this.onShowPopup()}
this.onShowPopup=function(){var $this=this;try{navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:this._camera_type}}).then(function(camera){$this._camera=camera;$this.showCameraCapture();$('#'+$this._sFormContainerId+' .bx-uploader-recording-start').show();$('#'+$this._sFormContainerId+' .bx-uploader-recording-stop').hide();$('#'+$this._sFormContainerId+' .bx-uploader-record-video-controls').show();navigator.mediaDevices.enumerateDevices().then(function(mediaDevices){let constraints=navigator.mediaDevices.getSupportedConstraints();if($this.getDevicesNum(mediaDevices)>1&&typeof constraints.facingMode!='undefined'&&constraints.facingMode){$('#'+$this._sFormContainerId+' .bx-record-camera-switch').show()}else{$('#'+$this._sFormContainerId+' .bx-record-camera-switch').hide()}})})}catch(err){$this._showError(_t('_sys_uploader_camera_capture_failed'))}}
this.onClickCancel=function(){this.releaseCamera();BxDolUploaderBase.prototype.onClickCancel.call(this)}
this.startRecording=function(){this._recorder=RecordRTC(this._camera,{type:'video',audioBitsPerSecond:this._audio_bitrate,videoBitsPerSecond:this._video_bitrate,disableLogs:!0});if(!this._recorder){this._showError(_t('_sys_uploader_unsupported_browser'));return}
$("#"+this._sFormContainerId+" .bx-btn.bx-btn-primary:not(.bx-crop-upload)").hide();$('#'+this._sFormContainerId+' .bx-uploader-recording-start').hide();$('#'+this._sFormContainerId+' .bx-uploader-recording-stop').show();this._recorder.startRecording();this.showCameraCapture()}
this.stopRecording=function(bSubmitWhenReady){$('#'+this._sFormContainerId+' .bx-uploader-recording-start').show();$('#'+this._sFormContainerId+' .bx-uploader-recording-stop').hide();var $this=this;this._recorder.stopRecording(function(){$this._blob=$this._recorder.getBlob();$this.showRecordingPreview();$this._recorder.destroy();$this._recorder=null;$("#"+$this._sFormContainerId+" .bx-btn.bx-btn-primary:not(.bx-crop-upload)").show();if(bSubmitWhenReady)
$this.submitRecording($('#'+$this._sFormContainerId+' form').get(0));})}
this.showCameraCapture=function(){var video=$('#bx-upoloader-recording-preview').hide().get(0);if(video.pause!=='undefined')video.pause();video.removeAttribute('src');video=$('#bx-upoloader-camera-capture').show().get(0);video.srcObject=this._camera;video.muted=!0;video.volume=0;$('#'+this._sFormContainerId+' .bx-record-video-preview .bx-record-video-preview-filesize').html('')}
this.showRecordingPreview=function(){$('#bx-upoloader-camera-capture').hide();$('#bx-upoloader-recording-preview').show().get(0).src=URL.createObjectURL(this._blob);var mbytes=(this._blob.size/1024/1024).toFixed(2);$('#'+this._sFormContainerId+' .bx-record-video-preview .bx-record-video-preview-filesize').html(mbytes+' '+_t('_sys_uploader_record_video_mb'))}
this.submitRecording=function(form){if(this._recorder){this.stopRecording(!0);return}
this.onBeforeUpload(form);var data=new FormData(form);if(this._blob!=null)data.append("f[]",this._blob,new Date().toISOString()+'.webm');var $this=this;$.ajax({url:$(form).attr('action'),type:"POST",data:data,processData:!1,contentType:!1,success:function(sErrorMsg,textStatus,jqXHR){$this.onUploadCompleted(sErrorMsg);if(!sErrorMsg.length){$this.releaseCamera()}},})}
this.releaseCamera=function(){var video=$('#bx-upoloader-recording-preview').get(0);if(video.pause!='undefined')video.pause();video.removeAttribute('src');if(this._recorder){this._recorder.destroy();this._recorder=null}
if(this._camera){if(typeof this._camera.stop!='undefined')this._camera.stop();this._camera.getTracks().forEach(function(track){if(track.readyState=='live'){track.stop()}})}}
this.getDevicesNum=function(mediaDevices){let count=0;mediaDevices.forEach(mediaDevice=>{if(mediaDevice.kind==='videoinput')count++});return count}}
BxDolUploaderRecordVideo.prototype=BxDolUploaderBase.prototype;function BxDolImageTweak(unique_id,action_url,content_id,field,js_object,allow_tweak){var $this=this;this._sUniqueId=unique_id;this._sActionUrl=action_url;this._sContentId=content_id;this._sField=field;this._sJsObject=js_object;this._bAllowTweak=allow_tweak;this._oContainerButtons=$('.bx-image-edit-buttons-'+unique_id);this._oContainerButtons.removeClass('hidden');$("#bx-form-input-files-"+this._sUniqueId+"-upload-result").bind("contentchange",function(){$this.uploadComplete($(this))});if(this._bAllowTweak){this._oContainerButtons.find('.bx-image-edit-buttons-edit').removeClass('hidden')}}
BxDolImageTweak.prototype.showUploaderForm=function(){var $this=this;$('#bx-form-input-files-'+$this._sUniqueId+'-upload-result').html('');eval($this._sJsObject+'.showUploaderForm()')}
BxDolImageTweak.prototype.uploadComplete=function(obj){var $this=this;var sUrl=$this._sActionUrl+"updateImage/"+$this._sField+"/"+$this._sContentId+"/"+obj.html()+"/";$this._oContainerButtons.removeClass('bx-image-edit-buttons-no-image');$.post(sUrl,function(aData){if($this._bAllowTweak){$(".bx-image-edit-source-"+$this._sUniqueId).css("background-image","url("+aData+")").css('background-position','');$(".bx-image-edit-source-"+$this._sUniqueId).parents('.bx-base-pofile-cover-image.bx-bpci-holder').removeClass('bx-bpci-holder h-32 lg:h-32').addClass('h-64 lg:h-80')}else{$(".bx-image-edit-source-"+$this._sUniqueId).attr("src",aData).show();$(".bx-image-edit-source-"+$this._sUniqueId).parents('.bx-base-pofile-cover-thumb').find('p.bx-base-pofile-unit-thumb').hide()}})}
BxDolImageTweak.prototype.changePosition=function(){var $this=this;$(".bx-image-edit-source-"+$this._sUniqueId).parent().append("<div class='bx-image-edit-move-info'><i class='sys-icon sys-colored arrows-alt '></i>"+_t('_sys_uploader_image_reposition_info')+"</div>");$(".bx-image-edit-source-"+$this._sUniqueId).addClass('bx-image-edit-move').bind('dragover',function(e){$(".bx-image-edit-source-"+$this._sUniqueId).parent().find('.bx-image-edit-move-info').remove();$(".bx-image-edit-source-"+$this._sUniqueId).css('background-position'," 0px "+e.offsetY/$(e.currentTarget).height()*100+'%')});with($this._oContainerButtons){find('.bx-image-edit-buttons-cancel').removeClass('hidden');find('.bx-image-edit-buttons-save').removeClass('hidden');find('.bx-image-edit-buttons-edit').addClass('hidden');find('.bx-image-edit-buttons-upload').addClass('hidden')}}
BxDolImageTweak.prototype.cancelPosition=function(){var $this=this;$(".bx-image-edit-source-"+$this._sUniqueId).parent().find('.bx-image-edit-move-info').remove();$(".bx-image-edit-source-"+$this._sUniqueId).addClass('bx-image-edit-move').unbind('dragover');with($this._oContainerButtons){find('.bx-image-edit-buttons-cancel').addClass('hidden');find('.bx-image-edit-buttons-save').addClass('hidden');find('.bx-image-edit-buttons-edit').removeClass('hidden');find('.bx-image-edit-buttons-upload').removeClass('hidden')}}
BxDolImageTweak.prototype.savePosition=function(){var $this=this;$(".bx-image-edit-source-"+$this._sUniqueId).parent().find('.bx-image-edit-move-info').remove();$(".bx-image-edit-source-"+$this._sUniqueId).addClass('bx-image-edit-move').unbind('dragover');$(".bx-image-edit-source-"+$this._sUniqueId).removeClass('bx-image-edit-move')
aPos=$(".bx-image-edit-source-"+$this._sUniqueId).css('background-position').split(' ');$.post($this._sActionUrl+'updateImagePosition/'+$this._sContentId+'/'+$this._sField+'/'+aPos[0].replace('%','').replace('px','')+'/'+aPos[1].replace('%','').replace('px','')+'/',function(){with($this._oContainerButtons){find('.bx-image-edit-buttons-cancel').addClass('hidden');find('.bx-image-edit-buttons-save').addClass('hidden');find('.bx-image-edit-buttons-edit').removeClass('hidden');find('.bx-image-edit-buttons-upload').removeClass('hidden')}})}
 }

/*--- BEGIN: http://localhost/UNA-Update//plugins_public/croppie/croppie.min.js---*/
!function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e.commonJsStrict={})}(this,function(e){"function"!=typeof Promise&&function(e){function t(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],s(e,t(o,this),t(r,this))}function n(e){var t=this;return null===this._state?void this._deferreds.push(e):void h(function(){var i=t._state?e.onFulfilled:e.onRejected;if(null!==i){var n;try{n=i(t._value)}catch(t){return void e.reject(t)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)})}function o(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if("function"==typeof i)return void s(t(i,e),t(o,this),t(r,this))}this._state=!0,this._value=e,a.call(this)}catch(e){r.call(this,e)}}function r(e){this._state=!1,this._value=e,a.call(this)}function a(){for(var e=0,t=this._deferreds.length;t>e;e++)n.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,i){var n=!1;try{e(function(e){n||(n=!0,t(e))},function(e){n||(n=!0,i(e))})}catch(e){if(n)return;n=!0,i(e)}}var l=setTimeout,h="function"==typeof setImmediate&&setImmediate||function(e){l(e,1)},u=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var o=this;return new i(function(i,r){n.call(o,new function(e,t,i,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=i,this.reject=n}(e,t,i,r))})},i.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&u(arguments[0])?arguments[0]:arguments);return new i(function(t,i){function n(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){n(r,e)},i)}e[r]=a,0==--o&&t(e)}catch(e){i(e)}}if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)n(r,e[r])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,i){i(e)})},i.race=function(e){return new i(function(t,i){for(var n=0,o=e.length;o>n;n++)e[n].then(t,i)})},i._setImmediateFn=function(e){h=e},"undefined"!=typeof module&&module.exports?module.exports=i:e.Promise||(e.Promise=i)}(this),"function"!=typeof window.CustomEvent&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,i){for(var n=atob(this.toDataURL(t,i).split(",")[1]),o=n.length,r=new Uint8Array(o),a=0;a<o;a++)r[a]=n.charCodeAt(a);e(new Blob([r],{type:t||"image/png"}))}});var t,i,n,o=["Webkit","Moz","ms"],r=document.createElement("div").style,a=[1,8,3,6],s=[2,7,4,5];function l(e){if(e in r)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=o.length;i--;)if((e=o[i]+t)in r)return e}function h(e,t){e=e||{};for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(e[i]=e[i]||{},h(e[i],t[i])):e[i]=t[i];return e}function u(e){return h({},e)}function c(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function p(e,t,i){if("string"==typeof t){var n=t;(t={})[n]=i}for(var o in t)e.style[o]=t[o]}function d(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function m(e,t){for(var i in t)e.setAttribute(i,t[i])}function f(e){return parseInt(e,10)}function v(e,t){var i=e.naturalWidth,n=e.naturalHeight,o=t||b(e);if(o&&o>=5){var r=i;i=n,n=r}return{width:i,height:n}}i=l("transform"),t=l("transformOrigin"),n=l("userSelect");var g={translate3d:{suffix:", 0px"},translate:{suffix:""}},w=function(e,t,i){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(i)};w.parse=function(e){return e.style?w.parse(e.style[i]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?w.fromMatrix(e):w.fromString(e)},w.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new w(f(t[4]),f(t[5]),parseFloat(t[0]))},w.fromString=function(e){var t=e.split(") "),i=t[0].substring(q.globals.translate.length+1).split(","),n=t.length>1?t[1].substring(6):1,o=i.length>1?i[0]:0,r=i.length>1?i[1]:0;return new w(o,r,n)},w.prototype.toString=function(){var e=g[q.globals.translate].suffix||"";return q.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var y=function(e){if(!e||!e.style[t])return this.x=0,void(this.y=0);var i=e.style[t].split(" ");this.x=parseFloat(i[0]),this.y=parseFloat(i[1])};function b(e){return e.exifdata?e.exifdata.Orientation:1}function x(e,t,i){var n=t.width,o=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),i){case 2:r.translate(n,0),r.scale(-1,1);break;case 3:r.translate(n,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:e.width=o,e.height=n,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=o,e.height=n,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:e.width=o,e.height=n,r.rotate(-90*Math.PI/180),r.translate(-n,o),r.scale(1,-1);break;case 8:e.width=o,e.height=n,r.translate(0,n),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,n,o),r.restore()}function C(){var e,t,o,r,a,s=this.options.viewport.type?"cr-vp-"+this.options.viewport.type:null;this.options.useCanvas=this.options.enableOrientation||E.call(this),this.data={},this.elements={},e=this.elements.boundary=document.createElement("div"),t=this.elements.viewport=document.createElement("div"),this.elements.img=document.createElement("img"),o=this.elements.overlay=document.createElement("div"),this.options.useCanvas?(this.elements.canvas=document.createElement("canvas"),this.elements.preview=this.elements.canvas):this.elements.preview=this.elements.img,d(e,"cr-boundary"),e.setAttribute("aria-dropeffect","none"),r=this.options.boundary.width,a=this.options.boundary.height,p(e,{width:r+(isNaN(r)?"":"px"),height:a+(isNaN(a)?"":"px")}),d(t,"cr-viewport"),s&&d(t,s),p(t,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),t.setAttribute("tabindex",0),d(this.elements.preview,"cr-image"),m(this.elements.preview,{alt:"preview","aria-grabbed":"false"}),d(o,"cr-overlay"),this.element.appendChild(e),e.appendChild(this.elements.preview),e.appendChild(t),e.appendChild(o),d(this.element,"croppie-container"),this.options.customClass&&d(this.element,this.options.customClass),function(){var e,t,o,r,a,s=this,l=!1;function h(e,t){var i=s.elements.preview.getBoundingClientRect(),n=a.y+t,o=a.x+e;s.options.enforceBoundary?(r.top>i.top+t&&r.bottom<i.bottom+t&&(a.y=n),r.left>i.left+e&&r.right<i.right+e&&(a.x=o)):(a.y=n,a.x=o)}function u(e){s.elements.preview.setAttribute("aria-grabbed",e),s.elements.boundary.setAttribute("aria-dropeffect",e?"move":"none")}function d(i){if((void 0===i.button||0===i.button)&&(i.preventDefault(),!l)){if(l=!0,e=i.pageX,t=i.pageY,i.touches){var o=i.touches[0];e=o.pageX,t=o.pageY}u(l),a=w.parse(s.elements.preview),window.addEventListener("mousemove",m),window.addEventListener("touchmove",m),window.addEventListener("mouseup",f),window.addEventListener("touchend",f),document.body.style[n]="none",r=s.elements.viewport.getBoundingClientRect()}}function m(n){n.preventDefault();var r=n.pageX,l=n.pageY;if(n.touches){var u=n.touches[0];r=u.pageX,l=u.pageY}var d=r-e,m=l-t,f={};if("touchmove"===n.type&&n.touches.length>1){var v=n.touches[0],g=n.touches[1],w=Math.sqrt((v.pageX-g.pageX)*(v.pageX-g.pageX)+(v.pageY-g.pageY)*(v.pageY-g.pageY));o||(o=w/s._currentZoom);var y=w/o;return L.call(s,y),void c(s.elements.zoomer)}h(d,m),f[i]=a.toString(),p(s.elements.preview,f),R.call(s),t=l,e=r}function f(){u(l=!1),window.removeEventListener("mousemove",m),window.removeEventListener("touchmove",m),window.removeEventListener("mouseup",f),window.removeEventListener("touchend",f),document.body.style[n]="",B.call(s),Y.call(s),o=0}s.elements.overlay.addEventListener("mousedown",d),s.elements.viewport.addEventListener("keydown",function(e){var t=37,l=38,u=39,c=40;if(!e.shiftKey||e.keyCode!==l&&e.keyCode!==c){if(s.options.enableKeyMovement&&e.keyCode>=37&&e.keyCode<=40){e.preventDefault();var d=function(e){switch(e){case t:return[1,0];case l:return[0,1];case u:return[-1,0];case c:return[0,-1]}}(e.keyCode);a=w.parse(s.elements.preview),document.body.style[n]="none",r=s.elements.viewport.getBoundingClientRect(),function(e){var t=e[0],r=e[1],l={};h(t,r),l[i]=a.toString(),p(s.elements.preview,l),R.call(s),document.body.style[n]="",B.call(s),Y.call(s),o=0}(d)}}else{var m=0;m=e.keyCode===l?parseFloat(s.elements.zoomer.value,10)+parseFloat(s.elements.zoomer.step,10):parseFloat(s.elements.zoomer.value,10)-parseFloat(s.elements.zoomer.step,10),s.setZoom(m)}}),s.elements.overlay.addEventListener("touchstart",d)}.call(this),this.options.enableZoom&&function(){var e=this,t=e.elements.zoomerWrap=document.createElement("div"),i=e.elements.zoomer=document.createElement("input");function n(){_.call(e,{value:parseFloat(i.value),origin:new y(e.elements.preview),viewportRect:e.elements.viewport.getBoundingClientRect(),transform:w.parse(e.elements.preview)})}function o(t){var i,o;if("ctrl"===e.options.mouseWheelZoom&&!0!==t.ctrlKey)return 0;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0,o=e._currentZoom+i*e._currentZoom,t.preventDefault(),L.call(e,o),n.call(e)}d(t,"cr-slider-wrap"),d(i,"cr-slider"),i.type="range",i.step="0.0001",i.value=1,i.style.display=e.options.showZoomer?"":"none",i.setAttribute("aria-label","zoom"),e.element.appendChild(t),t.appendChild(i),e._currentZoom=1,e.elements.zoomer.addEventListener("input",n),e.elements.zoomer.addEventListener("change",n),e.options.mouseWheelZoom&&(e.elements.boundary.addEventListener("mousewheel",o),e.elements.boundary.addEventListener("DOMMouseScroll",o))}.call(this),this.options.enableResize&&function(){var e,t,i,o,r,a,s,l=this,h=document.createElement("div"),u=!1,c=50;d(h,"cr-resizer"),p(h,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(d(a=document.createElement("div"),"cr-resizer-vertical"),h.appendChild(a));this.options.resizeControls.width&&(d(s=document.createElement("div"),"cr-resizer-horisontal"),h.appendChild(s));function m(a){if((void 0===a.button||0===a.button)&&(a.preventDefault(),!u)){var s=l.elements.overlay.getBoundingClientRect();if(u=!0,t=a.pageX,i=a.pageY,e=-1!==a.currentTarget.className.indexOf("vertical")?"v":"h",o=s.width,r=s.height,a.touches){var h=a.touches[0];t=h.pageX,i=h.pageY}window.addEventListener("mousemove",f),window.addEventListener("touchmove",f),window.addEventListener("mouseup",v),window.addEventListener("touchend",v),document.body.style[n]="none"}}function f(n){var a=n.pageX,s=n.pageY;if(n.preventDefault(),n.touches){var u=n.touches[0];a=u.pageX,s=u.pageY}var d=a-t,m=s-i,f=l.options.viewport.height+m,v=l.options.viewport.width+d;"v"===e&&f>=c&&f<=r?(p(h,{height:f+"px"}),l.options.boundary.height+=m,p(l.elements.boundary,{height:l.options.boundary.height+"px"}),l.options.viewport.height+=m,p(l.elements.viewport,{height:l.options.viewport.height+"px"})):"h"===e&&v>=c&&v<=o&&(p(h,{width:v+"px"}),l.options.boundary.width+=d,p(l.elements.boundary,{width:l.options.boundary.width+"px"}),l.options.viewport.width+=d,p(l.elements.viewport,{width:l.options.viewport.width+"px"})),R.call(l),k.call(l),B.call(l),Y.call(l),i=s,t=a}function v(){u=!1,window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v),document.body.style[n]=""}a&&(a.addEventListener("mousedown",m),a.addEventListener("touchstart",m));s&&(s.addEventListener("mousedown",m),s.addEventListener("touchstart",m));this.elements.boundary.appendChild(h)}.call(this)}function E(){return this.options.enableExif&&window.EXIF}function L(e){if(this.options.enableZoom){var t=this.elements.zoomer,i=j(e,4);t.value=Math.max(t.min,Math.min(t.max,i))}}function _(e){var n=this,o=e?e.transform:w.parse(n.elements.preview),r=e?e.viewportRect:n.elements.viewport.getBoundingClientRect(),a=e?e.origin:new y(n.elements.preview);function s(){var e={};e[i]=o.toString(),e[t]=a.toString(),p(n.elements.preview,e)}if(n._currentZoom=e?e.value:n._currentZoom,o.scale=n._currentZoom,n.elements.zoomer.setAttribute("aria-valuenow",n._currentZoom),s(),n.options.enforceBoundary){var l=function(e){var t=this._currentZoom,i=e.width,n=e.height,o=this.elements.boundary.clientWidth/2,r=this.elements.boundary.clientHeight/2,a=this.elements.preview.getBoundingClientRect(),s=a.width,l=a.height,h=i/2,u=n/2,c=-1*(h/t-o),p=-1*(u/t-r),d=1/t*h,m=1/t*u;return{translate:{maxX:c,minX:c-(s*(1/t)-i*(1/t)),maxY:p,minY:p-(l*(1/t)-n*(1/t))},origin:{maxX:s*(1/t)-d,minX:d,maxY:l*(1/t)-m,minY:m}}}.call(n,r),h=l.translate,u=l.origin;o.x>=h.maxX&&(a.x=u.minX,o.x=h.maxX),o.x<=h.minX&&(a.x=u.maxX,o.x=h.minX),o.y>=h.maxY&&(a.y=u.minY,o.y=h.maxY),o.y<=h.minY&&(a.y=u.maxY,o.y=h.minY)}s(),X.call(n),Y.call(n)}function B(){var e=this._currentZoom,n=this.elements.preview.getBoundingClientRect(),o=this.elements.viewport.getBoundingClientRect(),r=w.parse(this.elements.preview.style[i]),a=new y(this.elements.preview),s=o.top-n.top+o.height/2,l=o.left-n.left+o.width/2,h={},u={};h.y=s/e,h.x=l/e,u.y=(h.y-a.y)*(1-e),u.x=(h.x-a.x)*(1-e),r.x-=u.x,r.y-=u.y;var c={};c[t]=h.x+"px "+h.y+"px",c[i]=r.toString(),p(this.elements.preview,c)}function R(){if(this.elements){var e=this.elements.boundary.getBoundingClientRect(),t=this.elements.preview.getBoundingClientRect();p(this.elements.overlay,{width:t.width+"px",height:t.height+"px",top:t.top-e.top+"px",left:t.left-e.left+"px"})}}y.prototype.toString=function(){return this.x+"px "+this.y+"px"};var Z,z,M,I,X=(Z=R,z=500,function(){var e=this,t=arguments,i=M&&!I;clearTimeout(I),I=setTimeout(function(){I=null,M||Z.apply(e,t)},z),i&&Z.apply(e,t)});function Y(){var e,t=this.get();F.call(this)&&(this.options.update.call(this,t),this.$&&"undefined"==typeof Prototype?this.$(this.element).trigger("update.croppie",t):(window.CustomEvent?e=new CustomEvent("update",{detail:t}):(e=document.createEvent("CustomEvent")).initCustomEvent("update",!0,!0,t),this.element.dispatchEvent(e)))}function F(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function W(){var e,n={},o=this.elements.preview,r=new w(0,0,1),a=new y;F.call(this)&&!this.data.bound&&(this.data.bound=!0,n[i]=r.toString(),n[t]=a.toString(),n.opacity=1,p(o,n),e=this.elements.preview.getBoundingClientRect(),this._originalImageWidth=e.width,this._originalImageHeight=e.height,this.data.orientation=b(this.elements.img),this.options.enableZoom?k.call(this,!0):this._currentZoom=1,r.scale=this._currentZoom,n[i]=r.toString(),p(o,n),this.data.points.length?function(e){if(4!==e.length)throw"Croppie - Invalid number of points supplied: "+e;var n=e[2]-e[0],o=this.elements.viewport.getBoundingClientRect(),r=this.elements.boundary.getBoundingClientRect(),a={left:o.left-r.left,top:o.top-r.top},s=o.width/n,l=e[1],h=e[0],u=-1*e[1]+a.top,c=-1*e[0]+a.left,d={};d[t]=h+"px "+l+"px",d[i]=new w(c,u,s).toString(),p(this.elements.preview,d),L.call(this,s),this._currentZoom=s}.call(this,this.data.points):function(){var e=this.elements.preview.getBoundingClientRect(),t=this.elements.viewport.getBoundingClientRect(),n=this.elements.boundary.getBoundingClientRect(),o=t.left-n.left,r=t.top-n.top,a=o-(e.width-t.width)/2,s=r-(e.height-t.height)/2,l=new w(a,s,this._currentZoom);p(this.elements.preview,i,l.toString())}.call(this),B.call(this),R.call(this))}function k(e){var t,i,n,o,r=0,a=this.options.maxZoom||1.5,s=this.elements.zoomer,l=parseFloat(s.value),h=this.elements.boundary.getBoundingClientRect(),u=v(this.elements.img,this.data.orientation),p=this.elements.viewport.getBoundingClientRect();this.options.enforceBoundary&&(n=p.width/u.width,o=p.height/u.height,r=Math.max(n,o)),r>=a&&(a=r+1),s.min=j(r,4),s.max=j(a,4),!e&&(l<s.min||l>s.max)?L.call(this,l<s.min?s.min:s.max):e&&(i=Math.max(h.width/u.width,h.height/u.height),t=null!==this.data.boundZoom?this.data.boundZoom:i,L.call(this,t)),c(s)}function A(e){var t=e.points,i=f(t[0]),n=f(t[1]),o=f(t[2])-i,r=f(t[3])-n,a=e.circle,s=document.createElement("canvas"),l=s.getContext("2d"),h=e.outputWidth||o,u=e.outputHeight||r;e.outputWidth&&e.outputHeight;return s.width=h,s.height=u,e.backgroundColor&&(l.fillStyle=e.backgroundColor,l.fillRect(0,0,h,u)),!1!==this.options.enforceBoundary&&(o=Math.min(o,this._originalImageWidth),r=Math.min(r,this._originalImageHeight)),l.drawImage(this.elements.preview,i,n,o,r,0,0,h,u),a&&(l.fillStyle="#fff",l.globalCompositeOperation="destination-in",l.beginPath(),l.arc(s.width/2,s.height/2,s.width/2,0,2*Math.PI,!0),l.closePath(),l.fill()),s}function O(e,t){var i,n,o,r,a=this,s=[],l=null,h=E.call(a);if("string"==typeof e)i=e,e={};else if(Array.isArray(e))s=e.slice();else{if(void 0===e&&a.data.url)return W.call(a),Y.call(a),null;i=e.url,s=e.points||[],l=void 0===e.zoom?null:e.zoom}return a.data.bound=!1,a.data.url=i||a.data.url,a.data.boundZoom=l,(n=i,o=h,r=new Image,r.style.opacity=0,new Promise(function(e){function t(){r.style.opacity=1,setTimeout(function(){e(r)},1)}r.removeAttribute("crossOrigin"),n.match(/^https?:\/\/|^\/\//)&&r.setAttribute("crossOrigin","anonymous"),r.onload=function(){o?EXIF.getData(r,function(){t()}):t()},r.src=n})).then(function(i){if(function(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){e.classList.add(t)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}.call(a,i),s.length)a.options.relative&&(s=[s[0]*i.naturalWidth/100,s[1]*i.naturalHeight/100,s[2]*i.naturalWidth/100,s[3]*i.naturalHeight/100]);else{var n,o,r=v(i),l=a.elements.viewport.getBoundingClientRect(),h=l.width/l.height;r.width/r.height>h?n=(o=r.height)*h:(n=r.width,o=r.height/h);var u=(r.width-n)/2,c=(r.height-o)/2,p=u+n,d=c+o;a.data.points=[u,c,p,d]}a.data.points=s.map(function(e){return parseFloat(e)}),a.options.useCanvas&&function(e){var t=this.elements.canvas,i=this.elements.img,n=t.getContext("2d"),o=E.call(this);e=this.options.enableOrientation&&e,n.clearRect(0,0,t.width,t.height),t.width=i.width,t.height=i.height,o&&!e?x(t,i,f(b(i)||0)):e&&x(t,i,e)}.call(a,e.orientation||1),W.call(a),Y.call(a),t&&t()}).catch(function(e){console.error("Croppie:"+e)})}function j(e,t){return parseFloat(e).toFixed(t||0)}function H(){var e=this.elements.preview.getBoundingClientRect(),t=this.elements.viewport.getBoundingClientRect(),i=t.left-e.left,n=t.top-e.top,o=(t.width-this.elements.viewport.offsetWidth)/2,r=(t.height-this.elements.viewport.offsetHeight)/2,a=i+this.elements.viewport.offsetWidth+o,s=n+this.elements.viewport.offsetHeight+r,l=this._currentZoom;(l===1/0||isNaN(l))&&(l=1);var h=this.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(h,i/l),n=Math.max(h,n/l),a=Math.max(h,a/l),s=Math.max(h,s/l),{points:[j(i),j(n),j(a),j(s)],zoom:l,orientation:this.data.orientation}}var N={type:"canvas",format:"png",quality:1},S=["jpeg","webp","png"];function P(e){var t=this,i=H.call(t),n=h(u(N),u(e)),o="string"==typeof e?e:n.type||"base64",r=n.size||"viewport",a=n.format,s=n.quality,l=n.backgroundColor,c="boolean"==typeof n.circle?n.circle:"circle"===t.options.viewport.type,m=t.elements.viewport.getBoundingClientRect(),f=m.width/m.height;return"viewport"===r?(i.outputWidth=m.width,i.outputHeight=m.height):"object"==typeof r&&(r.width&&r.height?(i.outputWidth=r.width,i.outputHeight=r.height):r.width?(i.outputWidth=r.width,i.outputHeight=r.width/f):r.height&&(i.outputWidth=r.height*f,i.outputHeight=r.height)),S.indexOf(a)>-1&&(i.format="image/"+a,i.quality=s),i.circle=c,i.url=t.data.url,i.backgroundColor=l,new Promise(function(e,n){switch(o.toLowerCase()){case"rawcanvas":e(A.call(t,i));break;case"canvas":case"base64":e(function(e){return A.call(this,e).toDataURL(e.format,e.quality)}.call(t,i));break;case"blob":(function(e){var t=this;return new Promise(function(i,n){A.call(t,e).toBlob(function(e){i(e)},e.format,e.quality)})}).call(t,i).then(e);break;default:e(function(e){var t=e.points,i=document.createElement("div"),n=document.createElement("img"),o=t[2]-t[0],r=t[3]-t[1];return d(i,"croppie-result"),i.appendChild(n),p(n,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),n.src=e.url,p(i,{width:o+"px",height:r+"px"}),i}.call(t,i))}})}function D(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t,i,n,o,r,l=this.elements.canvas;this.data.orientation=(t=this.data.orientation,i=e,n=a.indexOf(t)>-1?a:s,o=n.indexOf(t),r=i/90%n.length,n[(n.length+o+r%n.length)%n.length]),x(l,this.elements.img,this.data.orientation),k.call(this),_.call(this),copy=null}if(window.jQuery){var T=window.jQuery;T.fn.croppie=function(e){if("string"===typeof e){var t=Array.prototype.slice.call(arguments,1),i=T(this).data("croppie");return"get"===e?i.get():"result"===e?i.result.apply(i,t):"bind"===e?i.bind.apply(i,t):this.each(function(){var i=T(this).data("croppie");if(i){var n=i[e];if(!T.isFunction(n))throw"Croppie "+e+" method not found";n.apply(i,t),"destroy"===e&&T(this).removeData("croppie")}})}return this.each(function(){var t=new q(this,e);t.$=T,T(this).data("croppie",t)})}}function q(e,t){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=e,this.options=h(u(q.defaults),t),"img"===this.element.tagName.toLowerCase()){var i=this.element;d(i,"cr-original-image"),m(i,{"aria-hidden":"true",alt:""});var n=document.createElement("div");this.element.parentNode.appendChild(n),n.appendChild(i),this.element=n,this.options.url=this.options.url||i.src}if(C.call(this),this.options.url){var o={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,O.call(this,o)}}q.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},q.globals={translate:"translate3d"},h(q.prototype,{bind:function(e,t){return O.call(this,e,t)},get:function(){var e=H.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return P.call(this,e)},refresh:function(){return function(){W.call(this)}.call(this)},setZoom:function(e){L.call(this,e),c(this.elements.zoomer)},rotate:function(e){D.call(this,e)},destroy:function(){return function(){var e,t;this.element.removeChild(this.elements.boundary),e=this.element,t="croppie-container",e.classList?e.classList.remove(t):e.className=e.className.replace(t,""),this.options.enableZoom&&this.element.removeChild(this.elements.zoomerWrap),delete this.elements}.call(this)}}),e.Croppie=window.Croppie=q});
;
/*--- END: http://localhost/UNA-Update//plugins_public/croppie/croppie.min.js---*/

 {
function fviuDelete(sName,oLink){var $this=this;var oDate=new Date()}
function fvtTogglePopup(sName,oLink){var oPopup=$(oLink).parents('.bx-form-input-translator:first').find('#bx-form-field-translator-popup-'+sName);if(oPopup.filter(':visible').length>0){oPopup.dolPopupHide();return}
oPopup.dolPopup({moveToDocRoot:!1,pointer:{el:$(oLink)}})};function fvtSelectLanguage(sName,sLangName,oLink){var oTranslator=$(oLink).parents('.bx-form-input-translator:first');var sId='#bx-form-language-'+sName+'-'+sLangName;$(oLink).parent().siblings('.active:visible').hide().siblings('.not-active:hidden').show().siblings(sId+'-pas:visible').hide().siblings(sId+'-act:hidden').show();oTranslator.find('.bx-form-input-language-current').css('background-image',$(oLink).parent('.bx-form-input-language').css('background-image')).find('a').html($(oLink).html());oTranslator.find('#bx-form-field-translator-popup-'+sName).dolPopupHide();$(oLink).parents('#bx-form-element-'+sName+':first').find('.bx-form-input-translation:visible').hide().siblings('.bx-form-input-translation-'+sName+'-'+sLangName+':hidden').show()}
 }

 {
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('2.W=b(7){7=2.R({y:o,L:o,K:Y,x:o,A:o,n:o,J:Y},7);g(7.y){g(2.V(7.A)&&2.m(7.n)===\'o\'){7.n=b(M,z,e){7.A(z,e)}}D g(2.m(7.A)===2.m(7.n)===\'o\'){7.n=b(M,z,e){1j.X&&X.1i(\'W 1h 1g 1f h\',M,z,e)}}1e $.1d({m:\'1c\',y:7.y,L:7.L,K:7.K,1b:(2.T.S)?"6":"4",x:b(4){f h=k I(4);g(2.V(7.x))7.x(h)},n:7.n,J:7.J})}};b I(4){g(4)3.U(4)};I.v={m:\'\',p:\'\',d:\'\',c:\'\',j:\'\',U:b(4){g(2.T.S){f H=k 1a("19.18");H.17(4);4=H}g(2(\'9\',4).E==1){3.m=\'C\';f w=k F(4)}D g(2(\'h\',4).E==1){3.m=\'16\';f w=k G(4)}g(w)2.R(3,w)}};b s(){};s.v={d:\'\',c:\'\',j:\'\',l:\'\',r:\'\'};b G(4){3.u(4)};G.v={u:b(4){f 9=2(\'h\',4).a(0);3.p=\'1.0\';3.d=2(9).5(\'d:i\').6();3.c=2(9).5(\'c:i\').t(\'Q\');3.j=2(9).5(\'15:i\').6();3.B=2(9).t(\'4:14\');3.l=2(9).5(\'l:i\').6();3.q=k P();f h=3;2(\'13\',4).O(b(){f 8=k s();8.d=2(3).5(\'d\').a(0).6();8.c=2(3).5(\'c\').a(0).t(\'Q\');8.j=2(3).5(\'12\').a(0).6();8.l=2(3).5(\'l\').a(0).6();8.r=2(3).5(\'r\').a(0).6();h.q.N(8)})}};b F(4){3.u(4)};F.v={u:b(4){g(2(\'C\',4).E==0)3.p=\'1.0\';D 3.p=2(\'C\',4).a(0).t(\'p\');f 9=2(\'9\',4).a(0);3.d=2(9).5(\'d:i\').6();3.c=2(9).5(\'c:i\').6();3.j=2(9).5(\'j:i\').6();3.B=2(9).5(\'B:i\').6();3.l=2(9).5(\'11:i\').6();3.q=k P();f h=3;2(\'8\',4).O(b(){f 8=k s();8.d=2(3).5(\'d\').a(0).6();8.c=2(3).5(\'c\').a(0).6();8.j=2(3).5(\'j\').a(0).6();8.l=2(3).5(\'10\').a(0).6();8.r=2(3).5(\'Z\').a(0).6();h.q.N(8)})}};',62,82,'||jQuery|this|xml|find|text|options|item|channel|eq|function|link|title||var|if|feed|first|description|new|updated|type|error|null|version|items|id|JFeedItem|attr|_parse|prototype|feedClass|success|url|msg|failure|language|rss|else|length|JRss|JAtom|xmlDoc|JFeed|global|cache|data|xhr|push|each|Array|href|extend|msie|browser|parse|isFunction|getFeed|console|true|guid|pubDate|lastBuildDate|content|entry|lang|subtitle|atom|loadXML|XMLDOM|Microsoft|ActiveXObject|dataType|GET|ajax|return|load|to|failed|log|window'.split('|')))
 }

 {
(function($){$.fn.dolRSSFeed=function(oOptions){var oOptions=oOptions||{};return this.each(function(){var $Cont=$(this);var sRSSObject=$Cont.attr('rssobject');var iRSSID=$Cont.attr('rssid');if((!iRSSID||!sRSSObject)&&oOptions.forceUrl==undefined)
return!1;var iMaxNum=parseInt($Cont.attr('rssnum')||0);var iMemID=parseInt($Cont.attr('member')||0);var sFeedURL=(oOptions.forceUrl!=undefined)?oOptions.forceUrl:sUrlRoot+'get_rss_feed.php?object='+sRSSObject+'&id='+iRSSID+'&member='+iMemID;bx_loading_content($(this),!0,!0);if('undefined'===typeof(jQuery.browser))
jQuery.browser={"msie":!1};$.getFeed({url:sFeedURL,error:function(oResponse){if(typeof oOptions.onError=='function')
oOptions.onError();},success:function(feed){if(feed==undefined||!feed.items)
return;if(typeof oOptions.onLoad=='function')
oOptions.onLoad();var sCode='<div class="sys-rss-feed-wrapper bx-def-bc-margin bx-def-padding-sec-top">';var sTarget,iCount=0;for(var iItemId=0;iItemId<feed.items.length;iItemId ++){var item=feed.items[iItemId];var sDate='',oDate,a;if(null!=(a=item.updated.match(/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)Z/))){oDate=new Date(a[1],a[2]-1,a[3],a[4],a[5],a[6],0);sDate=oDate.toLocaleString()}else if(item.updated.length>0){oDate=new Date(item.updated.replace(/z$/i,"-00:00"));sDate=isNaN(oDate)?'':oDate.toLocaleString()}
sTarget='';if(item.link.substring(0,sUrlRoot.length)!=sUrlRoot)
sTarget='target="_blank"';sCode+='<div class="sys-rss-item-wrapper">'+'<div class="sys-rss-item-header bx-def-font-h2">'+'<a href="'+item.link+'" '+sTarget+'>'+item.title+'</a>'+'</div>'+'<div class="sys-rss-item-desc">'+item.description+'</div>'+'<div class="sys-rss-item-info bx-def-font-small bx-def-font-grayed">'+'<span>'+sDate+'</span>'+'</div>'+'</div>'+'<hr class="bx-def-hr bx-def-margin-sec-top bx-def-margin-sec-bottom" />';iCount ++;if(iCount==iMaxNum)
break}
sTarget='';if(feed.link.substring(0,sUrlRoot.length)!=sUrlRoot)
sTarget='target="_blank"';sCode+='</div>'+'<div class="sys-rss-read-more">'+'<i class="sys-icon link"></i><a href="'+feed.link+'" '+sTarget+' class="bx-def-margin-sec-left sys-rss-read-more-link">'+feed.title+'</a>'+'</div>';$Cont.hide().html(sCode);if(typeof oOptions.onBeforeShow=='function')
oOptions.onBeforeShow();$Cont.show();if(typeof oOptions.onShow=='function')
oOptions.onShow();}})})}})(jQuery)
 }

 {
function BxDolStudioPage(oOptions){this.sActionsUrl=oOptions.sActionUrl;this.sObjName=oOptions.sObjName==undefined?'oBxDolStudioPage':oOptions.sObjName;this.sAnimationEffect=oOptions.sAnimationEffect==undefined?'slide':oOptions.sAnimationEffect;this.iAnimationSpeed=oOptions.iAnimationSpeed==undefined?'slow':oOptions.iAnimationSpeed;this.oPopupOptions={fog:{color:'#fff',opacity:.7},closeOnOuterClick:!1}}
BxDolStudioPage.prototype.processJson=function(oData){bx_loading('bx-std-page-columns',!1);processJsonData(oData)};BxDolStudioPage.prototype.togglePopup=function(sName,oLink){var $this=this;var sId='#bx-std-pcap-menu-popup-'+sName;if($(sId+':visible').length>0){$(sId).dolPopupHide();return}
$(oLink).parent().addClass('bx-menu-tab-active');var oPopupOptions={pointer:{el:$(oLink)},onHide:function(){$(oLink).parent().removeClass('bx-menu-tab-active')}};switch(sName){case 'help':oPopupOptions=$.extend({},oPopupOptions,{onBeforeShow:function(){var oPopup=$(sId);var oPopupRss=oPopup.find('.RSSAggrCont');if(oPopupRss.contents().length)
return;oPopupRss.dolRSSFeed({onError:function(){oPopupRss.html(_t('_adm_txt_show_help_content_empty'));oPopup._dolPopupSetPosition(oPopupOptions)},onShow:function(){oPopup._dolPopupSetPosition(oPopupOptions)}});oPopup._dolPopupSetPosition(oPopupOptions)}});break}
if($(sId).html().length>0)
$(sId).dolPopup(oPopupOptions);}
 }

 {
function BxDolStudioDesigner(oOptions){this.sActionsUrl=oOptions.sActionUrl;this.sObjName=oOptions.sObjName==undefined?'oBxDolStudioDesigner':oOptions.sObjName;this.sParamPrefix=oOptions.sParamPrefix==undefined?'dsg':oOptions.sParamPrefix;this.sAnimationEffect=oOptions.sAnimationEffect==undefined?'fade':oOptions.sAnimationEffect;this.iAnimationSpeed=oOptions.iAnimationSpeed==undefined?'slow':oOptions.iAnimationSpeed;this.sCodeMirror=oOptions.sCodeMirror==undefined?'':oOptions.sCodeMirror;var $this=this;$(document).ready(function(){if($this.sCodeMirror!='')
$this.initCodeMirror($this.sCodeMirror);})}
BxDolStudioDesigner.prototype.initCodeMirror=function(sSelector){var oSelector=$(sSelector);for(var i=0;i<oSelector.length;i++){var e=CodeMirror.fromTextArea(oSelector.get(i),{lineNumbers:!0,mode:"htmlmixed",htmlMode:!0,matchBrackets:!0})}};BxDolStudioDesigner.prototype.makeDefault=function(sUri){var $this=this;var oDate=new Date();var aParams={_t:oDate.getTime()};aParams[this.sParamPrefix+'_action']='make_default';aParams[this.sParamPrefix+'_value']=sUri;$.post(this.sActionsUrl,aParams,function(oData){if(oData.code!=0&&oData.message.length>0){bx_alert(oData.message);return}
document.location.href=document.location.href},'json')};BxDolStudioDesigner.prototype.deleteIcon=function(sName){var $this=this;var oDate=new Date();var aParams={_t:oDate.getTime()};aParams[this.sParamPrefix+'_action']='delete_icon';aParams[this.sParamPrefix+'_value']=sName;$.post(this.sActionsUrl,aParams,function(oData){if(oData.code!=0&&oData.message.length>0){bx_alert(oData.message);return}
$('.adm-dsg-ip-'+sName).bx_anim('hide',$this.sAnimationEffect,$this.iAnimationSpeed,function(){$(this).remove()})},'json')};BxDolStudioDesigner.prototype.deleteCover=function(sType,iId){var $this=this;var oDate=new Date();var aParams={_t:oDate.getTime()};aParams[this.sParamPrefix+'_action']='delete_cover';aParams[this.sParamPrefix+'_value']=sType;$.post(this.sActionsUrl,aParams,function(oData){if(oData.code!=0&&oData.message.length>0){bx_alert(oData.message);return}
$('#bx-dsg-cover-'+iId).bx_anim('hide',$this.sAnimationEffect,$this.iAnimationSpeed,function(){$(this).remove()})},'json')}
 }

 {
function BxDolStudioLauncher(oOptions){this.sActionsUrl=oOptions.sActionUrl;this.sObjName=oOptions.sObjName==undefined?'oBxDolStudioLauncher':oOptions.sObjName;this.sAnimationEffect=oOptions.sAnimationEffect==undefined?'fade':oOptions.sAnimationEffect;this.iAnimationSpeed=oOptions.iAnimationSpeed==undefined?'fast':oOptions.iAnimationSpeed;this.bInit=oOptions.bInit==undefined?!0:oOptions.bInit;this.aJitterConf={item:'.bx-std-widget-icon',elements:'.bx-std-widget-actions,.bx-std-widget-icon-jitter,.bx-std-widget-caption-jitter'};this.aSortingConf={parent:'.bx-std-widgets',item:'.bx-std-widget',placeholder:'bx-std-widget bx-std-widget-empty'};if(this.bInit)
this.init();}
BxDolStudioLauncher.prototype.init=function(){var $this=this;$(document).ready(function(){$($this.aSortingConf.parent).sortable({disabled:!0,handle:'.bx-std-widget-icon-jitter > img',items:$this.aSortingConf.item,placeholder:$this.aSortingConf.placeholder,start:function(oEvent,oUi){oUi.item.addClass('bx-std-widget-dragging')},stop:function(oEvent,oUi){oUi.item.removeClass('bx-std-widget-dragging');$this.reorder(oUi.item)}});if($this._isFeatured())
$('.bx-menu-tab-featured').addClass('bx-menu-tab-active');})};BxDolStudioLauncher.prototype.browser=function(oLink,sType){var $this=this;var oDate=new Date();if(sType==undefined)
sType='';var oBrowser=$('#bx-std-launcher-browser');if(oBrowser.length>0){var fBrowserShow=function(){oBrowser.dolPopup({closeOnOuterClick:!0,pointer:{el:'.bx-menu-breadcrumb .bx-menu-bc-'+(sType.length>0?'type':'home'),align:'left',offset:'-16 0'},onBeforeShow:function(oPopup){$this.browserChangeType(oLink,sType)}})}
if(oBrowser.is(':visible'))
oBrowser.dolPopupHide({onHide:function(){if(oBrowser.find('.bx-std-lb-menu .bx-std-pmen-item.bx-std-pmen-item-'+sType+'.bx-menu-tab-active').length==0)
fBrowserShow();}});else fBrowserShow();return!1}
$.get(this.sActionsUrl,{action:'launcher-browser',type:sType,_t:oDate.getTime()},function(oData){processJsonData(oData)},'json');return!1};BxDolStudioLauncher.prototype.browserChangeType=function(oLink,sType){var sMenuActive='bx-menu-tab-active';var sContentActive='bx-std-lbw-active';var oMenuActive=$('.bx-std-launcher-browser .bx-std-lb-menu .bx-std-pmen-item.'+sMenuActive);if(oMenuActive.hasClass('bx-std-pmen-item-'+sType))
return;oMenuActive.removeClass(sMenuActive).siblings('.bx-std-pmen-item-'+sType).addClass(sMenuActive);$('.bx-std-launcher-browser .bx-std-lb-content .bx-std-lb-widgets.'+sContentActive).removeClass(sContentActive).siblings('.bx-std-lbw-'+sType).addClass(sContentActive)};BxDolStudioLauncher.prototype.updateCache=function(){var oDate=new Date();$.get(this.sActionsUrl,{action:'launcher-update-cache',_t:oDate.getTime()})};BxDolStudioLauncher.prototype.reorder=function(oDraggable){var oDate=new Date();$.post(this.sActionsUrl+'?'+oDraggable.parent('.bx-std-widgets').sortable('serialize',{key:'items[]'}),{action:'launcher-reorder',page:this.sScrollCurrent,_t:oDate.getTime()},function(oData){if(oData.code!=0){bx_alert(oData.message);return}},'json');return!0};BxDolStudioLauncher.prototype.featured=function(sPageName,oLink){var $this=this;var oDate=new Date();$.get(this.sActionsUrl,{action:'page-featured',page:sPageName,_t:oDate.getTime()},function(oData){$('.bx-popup-applied:visible').dolPopupHide();if(oData.code!=0){bx_alert(oData.message);return}
var oSettings=$(oLink).parents('.bx-mod-popup-settings:first');if(oSettings.length>0&&oData.widget_id!=undefined&&oData.widget.length>0){$('#bx-std-widget-'+oData.widget_id).replaceWith(oData.widget);if($this.bInit)
oBxDolStudioLauncher.enableJitter();}},'json');return!0};BxDolStudioLauncher.prototype.bookmark=function(sPageName,oLink){var oDate=new Date();$.get(this.sActionsUrl,{action:'page-bookmark',page:sPageName,_t:oDate.getTime()},function(oData){$('.bx-popup-applied:visible').dolPopupHide();if(oData.code!=0){bx_alert(oData.message);return}},'json');return!0};BxDolStudioLauncher.prototype.rearrange=function(iWidgetId,oSelect){var oDate=new Date();var oSelect=$(oSelect);var oPopup=oSelect.parents('.bx-popup');bx_loading(oPopup,!0);$.get(this.sActionsUrl,{action:'widget-rearrange',widget_id:iWidgetId,type:oSelect.val(),_t:oDate.getTime()},function(oData){bx_loading(oPopup,!1);processJsonData(oData)},'json');return!0};BxDolStudioLauncher.prototype.enableJitter=function(){this._disableFeatured();$('.bx-menu-tab-featured').removeClass('bx-menu-tab-active');$(this.aJitterConf.elements).fadeIn('fast');$(this.aJitterConf.item).removeClass('bx-std-widget-icon-trans');$(this.aSortingConf.parent).sortable('option','disabled',!1)};BxDolStudioLauncher.prototype.disableJitter=function(){$(this.aJitterConf.elements).fadeOut('fast');$(this.aJitterConf.item).addClass('bx-std-widget-icon-trans');$(this.aSortingConf.parent).sortable('option','disabled',!0)};BxDolStudioLauncher.prototype.enableFeatured=function(){this.disableJitter();$('.bx-menu-tab-edit').removeClass('bx-menu-tab-active');$.cookie('bx_studio_featured','1',{path:'/'});this._enableFeatured()};BxDolStudioLauncher.prototype.disableFeatured=function(){$.cookie('bx_studio_featured','0',{path:'/'});this._disableFeatured()};BxDolStudioLauncher.prototype._isFeatured=function(){return parseInt($.cookie('bx_studio_featured'))==1};BxDolStudioLauncher.prototype._enableFeatured=function(){var $this=this;$('.bx-std-widget:not(.bx-std-widget-icon-featured)').bx_anim('hide',this.sAnimationEffect,this.iAnimationSpeed)};BxDolStudioLauncher.prototype._disableFeatured=function(){var $this=this;$('.bx-std-widget:not(.bx-std-widget-icon-featured)').bx_anim('show',this.sAnimationEffect,this.iAnimationSpeed)}
 }

 {
function BxDolStudioMenuTop(oOptions){this.sActionsUrl=oOptions.sActionUrl;this.sObjName=oOptions.sObjName==undefined?'oBxDolStudioMenuTop':oOptions.sObjName;this.sAnimationEffect=oOptions.sAnimationEffect==undefined?'slide':oOptions.sAnimationEffect;this.iAnimationSpeed=oOptions.iAnimationSpeed==undefined?'slow':oOptions.iAnimationSpeed}
BxDolStudioMenuTop.prototype.clickEdit=function(oItem){$('.bx-popup-applied:visible').dolPopupHide();var oParent=$(oItem).parent();if(oParent.hasClass('bx-menu-tab-active')){oParent.removeClass('bx-menu-tab-active');oBxDolStudioLauncher.disableJitter()}else{oParent.addClass('bx-menu-tab-active');oBxDolStudioLauncher.enableJitter()}};BxDolStudioMenuTop.prototype.clickFeatured=function(oItem){$('.bx-popup-applied:visible').dolPopupHide();var oParent=$(oItem).parent();if(oParent.hasClass('bx-menu-tab-active')){oParent.removeClass('bx-menu-tab-active');oBxDolStudioLauncher.disableFeatured()}else{oParent.addClass('bx-menu-tab-active');oBxDolStudioLauncher.enableFeatured()}};BxDolStudioMenuTop.prototype.clickLogout=function(oItem){$(oItem).parent().toggleClass('bx-menu-tab-active')}
 }
